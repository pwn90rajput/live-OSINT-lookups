<!doctype html>
<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>OSINT Monitor — Full Dashboard</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script crossorigin src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
    <script crossorigin src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
    <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>
  </head>
  <body class="bg-gray-50">
    <div id="root"></div>

    <script type="text/babel">
      const { useMemo, useState } = React;
      const sleep = (ms) => new Promise((r) => setTimeout(r, ms));
      const pretty = (v) => (typeof v === 'string' ? v : JSON.stringify(v, null, 2));
      const uniq = (arr) => Array.from(new Set((arr || []).filter(Boolean)));
      const validDomain = (d) => /^(?:[a-z0-9](?:[a-z0-9-]{0,61}[a-z0-9])?\.)+[a-z]{2,}$/i.test(d || '');
      async function corsFetch(url, opts = {}) {
        try { const res = await fetch(url, opts); if (!res.ok) throw new Error(`HTTP ${res.status}`); return res; }
        catch (e) { const mirror = `https://r.jina.ai/http/${url.replace(/^https?:\/\//, '')}`; const res2 = await fetch(mirror); if (!res2.ok) throw new Error(`Mirror HTTP ${res2.status}`); return res2; }
      }
      function mmh3_32(key){function m(a,b){const l=a&65535,h=a>>>16,o=b&65535,p=b>>>16;return((l*o+(((l*p+h*o)&65535)<<16))>>>0)}const d=typeof key==='string'?new TextEncoder().encode(key):key,c1=3432918353>>>0,c2=461845907>>>0;let h1=0;const n=d.length,b=Math.floor(n/4),v=new DataView(d.buffer,d.byteOffset,d.byteLength);for(let i=0;i<b;i++){let k1=v.getUint32(i*4,true);k1=m(k1,c1);k1=((k1<<15)|(k1>>>17))>>>0;k1=m(k1,c2);h1^=k1;h1=((h1<<13)|(h1>>>19))>>>0;h1=(m(h1,5)+0xe6546b64)>>>0}let k1=0;const t=n&3;if(t===3)k1^=d[n-1]<<16;if(t>=2)k1^=d[n-2]<<8;if(t>=1){k1^=d[n-3];k1=m(k1,c1);k1=((k1<<15)|(k1>>>17))>>>0;k1=m(k1,c2);h1^=k1}h1^=n;h1^=h1>>>16;h1=m(h1,0x85ebca6b);h1^=h1>>>13;h1=m(h1,0xc2b2ae35);h1^=h1>>>16;return(h1|0)}
      async function fetchDNS(domain){const types=['A','AAAA','MX','TXT','CNAME','NS'];const records={};for(const t of types){try{const u=`https://cloudflare-dns.com/dns-query?name=${encodeURIComponent(domain)}&type=${t}`;const res=await fetch(u,{headers:{accept:'application/dns-json'}});const j=await res.json();records[t]=(j.Answer||[]).map((a)=>a.data)}catch(e){records[t]={error:String(e)}}}return records}
      async function fetchRDAP_Domain(domain){try{return await (await fetch(`https://rdap.org/domain/${domain}`)).json()}catch(e){return{error:String(e)}}}
      async function fetchCT(domain){const url=`https://crt.sh/?q=%25.${domain}&output=json`;try{const res=await corsFetch(url);const txt=await res.text();try{return JSON.parse(txt)}catch{const m=txt.match(/\[\{[\s\S]*\}\]/);if(m)return JSON.parse(m[0]);return{note:'CT mirror returned HTML; showing raw',raw:txt.slice(0,2000)}}}catch(e){return{error:String(e)}}}
      async function fetchURLScan(domain){try{return await (await fetch(`https://urlscan.io/api/v1/search/?q=domain:${encodeURIComponent(domain)}`)).json()}catch(e){return{error:String(e)}}}
      async function fetchSubdomains(domain){const out={sources:{},all:[]};const add=(n,a)=>{out.sources[n]=uniq(a||[]);out.all.push(...out.sources[n])};try{const r1=await fetch(`https://sonar.omnisint.io/subdomains/${domain}`);add('omnisint',(await r1.json())||[])}catch{add('omnisint',[])}try{const r2=await fetch(`https://jldc.me/anubis/subdomains/${domain}`);add('anubis',(await r2.json())||[])}catch{add('anubis',[])}try{const r3=await fetch(`https://dns.bufferover.run/dns?q=.${domain}`);const j=await r3.json();const set=new Set();for(const key of ['FDNS_A','RDNS','FDNS_TXT','FDNS_CNAME']){(j[key]||[]).forEach((line)=>{const parts=(line||'').split(',');const h=parts[1]||parts[0];if(h&&h.endsWith(domain))set.add(h.trim())})}add('bufferover',Array.from(set))}catch{add('bufferover',[])}out.all=uniq(out.all);return out}
      async function fetchIPIntel(ip){const out={};try{out.ipwhois=await (await fetch(`https://ipwho.is/${ip}`)).json()}catch(e){out.ipwhois={error:String(e)}}try{out.bgpview=await (await fetch(`https://api.bgpview.io/ip/${ip}`)).json()}catch(e){out.bgpview={error:String(e)}}try{out.internetdb=await (await fetch(`https://internetdb.shodan.io/${ip}`)).json()}catch(e){out.internetdb={error:String(e)}}return out}
      async function fetchSSLLabs(domain){try{let url=`https://api.ssllabs.com/api/v3/analyze?host=${encodeURIComponent(domain)}&fromCache=on&all=done`;let last=await (await fetch(url)).json();for(let i=0;i<3&&last.status&&/IN_PROGRESS|DNS/.test(last.status);i++){await sleep(4000);last=await (await fetch(url)).json()}return last}catch(e){return{error:String(e)}}}
      async function fetchRDAP_IP(ip){try{return await (await fetch(`https://rdap.org/ip/${ip}`)).json()}catch(e){return{error:String(e)}}}
      async function fetchFaviconHash(domain){try{const res=await fetch(`https://${domain}/favicon.ico`,{mode:'cors'});const buf=new Uint8Array(await res.arrayBuffer());const hash=mmh3_32(buf);return{mmh3:hash,note:'Shodan favicon hash compatible (signed int32)'}}catch(e){return{error:String(e)}}}
      function ExternalScanners({domain,ip,brand}){const d=encodeURIComponent(domain||'');const i=ip?encodeURIComponent(ip):'';const items=[{name:'VirusTotal (domain)',url:`https://www.virustotal.com/gui/domain/${d}`},{name:'URLVoid',url:`https://www.urlvoid.com/scan/${d}/`},{name:'Sucuri SiteCheck',url:`https://sitecheck.sucuri.net/results/${d}`},{name:'Talos Intelligence',url:`https://talosintelligence.com/reputation_center/lookup?search=${d}`},{name:'FortiGuard Lookup',url:`https://www.fortiguard.com/webfilter?q=${d}`},{name:'AbuseIPDB (IP)',url:ip?`https://abuseipdb.com/check/${i}`:null},{name:'Hybrid Analysis (domain)',url:`https://www.hybrid-analysis.com/search?query=${d}`},{name:'ThreatCrowd (domain)',url:`https://www.threatcrowd.org/domain.php?domain=${d}`},{name:'Wayback Machine',url:`https://web.archive.org/web/*/${d}`},{name:'Censys (search)',url:`https://search.censys.io/search?resource=hosts&q=${d}`},].filter(x=>x.url);return(<div className="space-y-2"><h3 className="text-lg font-semibold">Extra Free Scanners (quick links)</h3><ul className="list-disc pl-5">{items.map(x=>(<li key={x.name}><a className="underline" href={x.url} target="_blank" rel="noreferrer">{x.name}</a></li>))}</ul></div>)}
      function App(){
        const [domain,setDomain]=useState('example.com');
        const [brand,setBrand]=useState('example');
        const [loading,setLoading]=useState(false);
        const [error,setError]=useState('');
        const [data,setData]=useState({});
        const canScan=useMemo(()=>validDomain(domain),[domain]);
        const onDemo=()=>{setDomain('example.com');setBrand('example')};
        async function runScan(){setLoading(true);setError('');setData({});try{if(!canScan)throw new Error('Please enter a valid FQDN (e.g., example.com)');const dns=await fetchDNS(domain);const ip=(dns.A&&Array.isArray(dns.A)&&dns.A[0])?dns.A[0]:undefined;const rdapDomain=await fetchRDAP_Domain(domain);const subs=await fetchSubdomains(domain);const ct=await fetchCT(domain);const urlscan=await fetchURLScan(domain);const ssllabs=await fetchSSLLabs(domain);const fav=await fetchFaviconHash(domain);let ipIntel=null,rdapIP=null;if(ip){ipIntel=await fetchIPIntel(ip);rdapIP=await fetchRDAP_IP(ip)}setData({dns,ip,rdapDomain,subs,ct,urlscan,ssllabs,fav,ipIntel,rdapIP})}catch(e){setError(String(e.message||e))}finally{setLoading(false)}}
        function download(filename,text){const blob=new Blob([text],{type:'application/json'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=filename;a.click();URL.revokeObjectURL(url)}
        function toCSV(obj){const rows=[];const push=(k,v)=>rows.push([k,typeof v==='string'?v:JSON.stringify(v)].map(x=>'"'+x.replaceAll('"','""')+'"').join(','));if(!obj)return'key,value
';push('domain',domain);push('ip',data.ip||'');push('dns.A',(data.dns?.A||[]).join('|'));push('dns.MX',(data.dns?.MX||[]).join('|'));push('subs.count',data.subs?.all?.length||0);push('ssl.grade',data.ssllabs?.endpoints?.[0]?.grade||data.ssllabs?.status||'');return['key,value',...rows].join('
')}
        return(<div className="min-h-screen bg-gray-50 text-gray-900 p-6"><div className="max-w-6xl mx-auto space-y-6"><header className="flex items-center justify-between"><h1 className="text-2xl font-bold">OSINT Monitor — Full Dashboard <span className="text-sm font-normal">(Patched • Stable)</span></h1><div className="flex gap-2"><button onClick={onDemo} className="px-3 py-1 rounded-xl bg-gray-200">Demo</button><button onClick={()=>download(`${domain}.json`,pretty(data))} disabled={!data||Object.keys(data).length===0} className="px-3 py-1 rounded-xl bg-gray-200 disabled:opacity-50">Download JSON</button><button onClick={()=>download(`${domain}.csv`,toCSV(data))} disabled={!data||Object.keys(data).length===0} className="px-3 py-1 rounded-xl bg-gray-200 disabled:opacity-50">Download CSV</button></div></header><section className="bg-white rounded-2xl shadow p-4 space-y-3"><div className="grid md:grid-cols-3 gap-3"><div><label className="text-sm font-medium">Domain (FQDN)</label><input value={domain} onChange={(e)=>setDomain(e.target.value.trim())} className="w-full border rounded-xl px-3 py-2 mt-1" placeholder="example.com"/></div><div><label className="text-sm font-medium">Brand (no TLD)</label><input value={brand} onChange={(e)=>setBrand(e.target.value.trim())} className="w-full border rounded-xl px-3 py-2 mt-1" placeholder="example"/></div><div className="flex items-end gap-2"><button onClick={runScan} disabled={!canScan||loading} className="px-4 py-2 rounded-xl bg-black text-white disabled:opacity-50">{loading?'Scanning...':'Scan'}</button></div></div>{!canScan&&<p className="text-sm text-red-600">Enter a valid domain (e.g., acme.com).</p>}{error&&<p className="text-sm text-red-600">{error}</p>}<p className="text-xs text-gray-500">Front-end only. CORS-safe mirrors used when needed. Some sources may rate-limit; UI degrades gracefully.</p></section><section className="grid md:grid-cols-2 gap-4"><div className="bg-white rounded-2xl shadow p-4"><h3 className="font-semibold mb-2">Summary</h3><pre className="text-xs whitespace-pre-wrap">{pretty({domain,ip:data.ip,aRecords:data?.dns?.A,subs:data?.subs?.all?.length,sslGrade:data?.ssllabs?.endpoints?.[0]?.grade||data?.ssllabs?.status})}</pre></div><div className="bg-white rounded-2xl shadow p-4"><ExternalScanners domain={domain} ip={data.ip} brand={brand}/></div></section><section className="grid md:grid-cols-2 gap-4"><div className="bg-white rounded-2xl shadow p-4"><h3 className="font-semibold">WHOIS / RDAP (Domain)</h3><pre className="text-xs whitespace-pre-wrap">{pretty(data.rdapDomain)}</pre></div><div className="bg-white rounded-2xl shadow p-4"><h3 className="font-semibold">DNS Records (DoH)</h3><pre className="text-xs whitespace-pre-wrap">{pretty(data.dns)}</pre></div></section><section className="grid md:grid-cols-2 gap-4"><div className="bg-white rounded-2xl shadow p-4"><h3 className="font-semibold">Subdomains (Multi-source)</h3><pre className="text-xs whitespace-pre-wrap">{pretty(data.subs)}</pre></div><div className="bg-white rounded-2xl shadow p-4"><h3 className="font-semibold">Certificate Transparency (crt.sh)</h3><pre className="text-xs whitespace-pre-wrap">{pretty(data.ct)}</pre></div></section><section className="grid md:grid-cols-2 gap-4"><div className="bg-white rounded-2xl shadow p-4"><h3 className="font-semibold">SSL Labs (Grade)</h3><pre className="text-xs whitespace-pre-wrap">{pretty(data.ssllabs)}</pre></div><div className="bg-white rounded-2xl shadow p-4"><h3 className="font-semibold">URLScan.io</h3><pre className="text-xs whitespace-pre-wrap">{pretty(data.urlscan)}</pre></div></section><section className="grid md:grid-cols-2 gap-4"><div className="bg-white rounded-2xl shadow p-4"><h3 className="font-semibold">Favicon Hash (mmh3)</h3><pre className="text-xs whitespace-pre-wrap">{pretty(data.fav)}</pre></div><div className="bg-white rounded-2xl shadow p-4"><h3 className="font-semibold">IP Geo / ASN & Network Recon</h3><pre className="text-xs whitespace-pre-wrap">{pretty({ip:data.ip,ipIntel:data.ipIntel,rdapIP:data.rdapIP})}</pre></div></section><footer className="text-xs text-gray-500">Sources: Cloudflare DoH, rdap.org, ipwho.is, api.bgpview.io, rdap.org/ip, internetdb.shodan.io, urlscan.io, crt.sh (via mirror), sonar.omnisint, jldc.me (anubis), dns.bufferover.run, SSL Labs. Added quick links to 5+ free scanners (VT, Talos, Sucuri, URLVoid, FortiGuard, etc.).</footer></div></div>)}
      const root = ReactDOM.createRoot(document.getElementById('root'));
      root.render(React.createElement(App));
    </script>
  </body>
</html>
